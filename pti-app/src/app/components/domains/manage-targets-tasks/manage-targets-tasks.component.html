<h2>{{ domainName }}</h2>
<button (click)="toggleTargetInput()">+ Add Target</button>

<div *ngIf="showTargetInput">
    <input type="text" [(ngModel)]="newTarget.name" placeholder="Target Name">
    <input type="date" [(ngModel)]="newTarget.deadline">
    <button (click)="addTarget()">Save</button>
</div>

<div *ngFor="let target of targets">
    <h3>{{ target.name }} ({{ target.progress }}%)</h3>
    <p>Deadline: {{ target.deadline }}</p>
    <button *ngIf="target.id" (click)="toggleTaskInput(target.id)">+ Add Task</button>

    <div *ngIf="showTaskInput && selectedTargetId === target.id">
        <input type="text" [(ngModel)]="newTask.name" placeholder="Task Name">
        <input type="number" [(ngModel)]="newTask.estimatedTime" placeholder="Estimated Time (hrs)">
        <button (click)="addTask(target.id)">Save</button>
    </div>

    <ul>
        <li *ngFor="let task of target.tasks">
            <input type="checkbox" [(ngModel)]="task.completed" *ngIf="target.id"
                (change)="markTaskComplete(target.id, task)">
            {{ task.name }} - {{ task.estimatedTime }} hrs
        </li>
    </ul>
</div>

<button (click)="router.navigate(['/dashboard'])">Back</button>